[pytest]
minversion = 7.4
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Output options
addopts =
    -v
    --strict-markers
    --tb=short
    --disable-warnings
    --maxfail=5
    --color=yes

# Markers for test categorization
markers =
    critical: Critical security tests (OWASP Top 3)
    high: High priority security tests
    medium: Medium priority security tests
    low: Low priority security tests
    slow: Tests that take >5 seconds
    bola: API1 - Broken Object Level Authorization
    auth: API2 - Broken Authentication
    properties: API3 - Broken Object Property Level Authorization
    resources: API4 - Unrestricted Resource Consumption
    functions: API5 - Broken Function Level Authorization
    business: API6 - Unrestricted Access to Sensitive Business Flows
    ssrf: API7 - Server-Side Request Forgery
    misconfig: API8 - Security Misconfiguration
    inventory: API9 - Improper Inventory Management
    external: API10 - Unsafe Consumption of APIs
    injection: Injection attack tests (SQL, XSS, Command, etc.)
    websocket: WebSocket and Durable Objects security tests

# Timeout
timeout = 30
timeout_method = thread

# Coverage (optional)
# addopts = --cov=utils --cov-report=html
